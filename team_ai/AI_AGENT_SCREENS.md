# TeamAI - AI Agent Функционал

## Описание

Функционал AI Agent позволяет управлять проектами с автоматическим распределением задач на основе навыков и опыта участников команды.

## Реализованные экраны

### 1. AI Agent Screen (Список проектов)

**Файл:** `lib/screens/ai_agent/ai_agent_screen.dart`

**Функциональность:**
- Отображение списка всех проектов
- Пустое состояние с призывом создать проект
- Карточки проектов с информацией:
  - Категория проекта (цветная метка)
  - Дней до дедлайна
  - Название и описание
  - Количество участников команды
  - Количество задач
  - Прогресс выполнения (progress bar)
- Аватары участников команды (первые 3 + счетчик)
- Навигация к детальному просмотру проекта

**Пустое состояние:**
- Иконка AI
- Текст "Пока нет проектов"
- Описание функционала
- Кнопка "Создать проект"

---

### 2. Project Detail Screen (Детали проекта)

**Файл:** `lib/screens/ai_agent/project_detail_screen.dart`

**Функциональность:**
- Заголовок проекта с градиентом
- Информация о проекте:
  - Категория
  - Дней до дедлайна
  - Название и описание
  - Количество участников и задач
  - Прогресс выполнения
- Две вкладки:
  - **Все задачи** - все задачи проекта
  - **Мои задачи** - только задачи текущего пользователя
- AI Summary блок с объяснением распределения
- FAB кнопка для открытия AI Chat

**Карточка задачи (expandable):**
- Иконка статуса (todo/in progress/completed)
- Название задачи
- Исполнитель
- Дедлайн
- Приоритет (метка с цветом)

**Детали задачи (при раскрытии):**
- Описание задачи
- Требуемые навыки (chips)
- Оценка времени в часах
- **AI Reasoning блок** - объяснение от ИИ, почему задача назначена этому человеку

---

### 3. AI Chat Screen

**Файл:** `lib/screens/ai_agent/ai_chat_screen.dart`

**Функциональность:**
- Чат с AI помощником по проекту
- Начальное приветствие от AI
- Отправка и получение сообщений
- Индикатор набора текста (typing dots)
- Кнопки: добавить вложение, отправить
- Gradient аватар AI
- Автоматический скролл к последнему сообщению

**AI может отвечать на вопросы:**
- Количество задач и прогресс
- Дедлайны проекта
- Информация о команде
- Причины распределения задач
- Статус проекта

**Пустое состояние:**
- Gradient иконка AI
- Текст "Как я могу помочь вам сегодня?"
- Подсказка о возможностях

---

## Модели данных

### TeamMember
```dart
class TeamMember {
  String id;
  String name;
  String email;
  String role;
  String? avatarUrl;
  List<String> skills;
  int experienceYears;
}
```

### Task
```dart
class Task {
  String id;
  String title;
  String description;
  String assignedToId;
  String assignedToName;
  DateTime deadline;
  TaskStatus status; // todo, inProgress, completed
  TaskPriority priority; // low, medium, high, critical
  String aiReasoning; // Объяснение от ИИ
  List<String> requiredSkills;
  int estimatedHours;
}
```

### Project
```dart
class Project {
  String id;
  String title;
  String description;
  String category;
  DateTime startDate;
  DateTime deadline;
  ProjectStatus status; // planning, inProgress, completed, onHold
  List<TeamMember> teamMembers;
  List<Task> tasks;
  String aiSummary; // Краткое описание от ИИ
  double progress; // 0-100
}
```

---

## Ключевые возможности

### 1. Пустое состояние проектов
Если проектов нет:
- Показывается понятное сообщение
- Предлагается создать первый проект
- Объясняется как работает AI распределение

### 2. Карточки проектов
- Цветное разделение по категориям
- Визуальный прогресс выполнения
- Отображение команды (аватары)
- Информация о дедлайнах

### 3. Детальный просмотр задач
- Expandable карточки задач
- Полная информация о каждой задаче
- **AI Reasoning** - объяснение почему ИИ назначил задачу конкретному человеку
- Фильтрация: все задачи / мои задачи

### 4. AI Chat
- Интерактивное общение с AI
- Контекстные ответы по проекту
- Помощь в понимании распределения задач
- Информация о команде и дедлайнах

---

## Цветовая схема

### Статусы задач
- **Todo**: `#757575` (серый)
- **In Progress**: `#FF9800` (оранжевый)
- **Completed**: `#4CAF50` (зеленый)

### Приоритеты
- **Low**: `#4CAF50` (зеленый)
- **Medium**: `#00BCD4` (голубой)
- **High**: `#FF9800` (оранжевый)
- **Critical**: `#E53935` (красный)

### Категории проектов
- **Разработка**: `#4F9CF9` (синий)
- **Дизайн**: `#3D2E7C` (фиолетовый)
- **Маркетинг**: `#FF9800` (оранжевый)
- **Аналитика**: `#00BCD4` (бирюзовый)

---

## Навигация

```
Main Screen → AI Agent Tab
    ↓
AI Agent Screen (список проектов)
    ↓ (клик на проект)
Project Detail Screen
    ├─ Tab: Все задачи
    │   └─ Expandable Task Cards с AI Reasoning
    ├─ Tab: Мои задачи
    │   └─ Только задачи пользователя
    └─ FAB: AI Chat
        └─ AI Chat Screen
```

---

## TODO (Будущие улучшения)

### Интеграция
- [ ] Подключить backend API для проектов
- [ ] Реальное AI API для чата (OpenAI, Claude и т.д.)
- [ ] Система аутентификации пользователей
- [ ] Real-time обновления (WebSocket)

### Функционал создания проектов
- [ ] Форма создания проекта (в Calendar Screen)
- [ ] Поиск пользователей по email
- [ ] Добавление участников в проект
- [ ] Указание навыков при регистрации
- [ ] AI автоматическое распределение задач

### Управление задачами
- [ ] Изменение статуса задачи
- [ ] Редактирование задач
- [ ] Комментарии к задачам
- [ ] История изменений
- [ ] Push уведомления о дедлайнах

### AI функционал
- [ ] Анализ навыков команды
- [ ] Оптимальное распределение на основе загруженности
- [ ] Автоматические дедлайны
- [ ] Прогнозирование времени выполнения
- [ ] Рекомендации по оптимизации

### UI улучшения
- [ ] Pull-to-refresh для обновления списка
- [ ] Фильтры и сортировка проектов
- [ ] Поиск по задачам
- [ ] Drag & drop для изменения приоритета
- [ ] Темная тема

---

## Технические детали

### Зависимости
- `intl: ^0.19.0` - форматирование дат

### Mock данные
В `ai_agent_screen.dart` используются mock данные для демонстрации.
При интеграции с backend:
1. Удалить метод `_getMockProjects()`
2. Реализовать `_loadProjects()` с вызовом API
3. Добавить state management (Provider/Riverpod/Bloc)

### AI Chat
Сейчас используется простая логика на ключевых словах.
Для production:
1. Интегрировать с AI API
2. Добавить контекст о проекте
3. Сохранять историю чата
4. Добавить поддержку вложений

---

## Примеры использования

### Как ИИ распределяет задачи

Пример из mock данных:

**Задача**: "Создать UI компоненты"
- **Требуемые навыки**: Flutter, UI/UX
- **Назначена**: Алексей Иванов
- **AI Reasoning**: "Алексей имеет опыт в Flutter и UI/UX дизайне, что идеально подходит для этой задачи."

**Задача**: "Настроить API endpoints"
- **Требуемые навыки**: Node.js, Database
- **Назначена**: Мария Петрова
- **AI Reasoning**: "Мария специализируется на backend разработке и имеет большой опыт с Node.js."

---

## Формат данных API (рекомендуемый)

### GET /api/projects
```json
[
  {
    "id": "1",
    "title": "Разработка мобильного приложения",
    "description": "...",
    "category": "Разработка",
    "startDate": "2024-11-01T00:00:00Z",
    "deadline": "2024-12-01T00:00:00Z",
    "status": 1,
    "progress": 45,
    "aiSummary": "ИИ распределил задачи...",
    "teamMembers": [...],
    "tasks": [...]
  }
]
```

### POST /api/chat/message
```json
{
  "projectId": "1",
  "message": "Сколько задач в проекте?",
  "context": {
    "userId": "current_user_id"
  }
}
```

Response:
```json
{
  "response": "В проекте всего 5 задач...",
  "suggestions": ["Показать мои задачи", "Дедлайны"]
}
```
